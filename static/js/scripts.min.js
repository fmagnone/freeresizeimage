document.addEventListener("DOMContentLoaded",()=>{const IS_ROOT="/"==location.pathname;if(!IS_ROOT)return;const imagesContainer=document.getElementById("showContainer"),resizeOptionsContainer=document.getElementById("resizeOptionsContainer"),exampleImageContainer=document.getElementById("exampleImageContainer"),imageResizedContainer=document.getElementById("imageResizedContainer"),imagePrevContainer=document.getElementById("imagePrevContainer"),uploadBox=document.getElementById("upload-box"),liveAlertPlaceholder=document.getElementById("live-alert-placeholder"),resizeMethod=document.getElementById("resizeMethod"),optionsBoxMode=document.getElementById("options-box-mode"),optionsBoxPreset=document.getElementById("options-box-preset"),optionsBoxCustomSize=document.getElementById("options-box-custom-size"),optionsBoxPrecentage=document.getElementById("options-box-percentage"),presetListContainer=document.getElementById("presetListContainer"),inputSlider=document.getElementById("range"),inputWidth=document.getElementById("width"),inputHeight=document.getElementById("height"),cropModeCheckbox=document.getElementById("cropModeCheckbox"),containModeCheckbox=document.getElementById("containModeCheckbox"),autoForceWidthHeightCheckbox=document.getElementById("autoForceWidthHeightCheckbox"),backColorPicker=document.getElementById("backColorPicker"),updateCheckbox=document.getElementById("updateCheckbox"),updateButton=document.getElementById("updateButton"),exampleImage=document.getElementsByClassName("example-image"),showTitle=document.getElementById("show-title"),showDescription=document.getElementById("show-description"),showSingleBox=document.getElementById("show-single"),showMultipleBox=document.getElementById("show-multiple");var presetSizeCategorySet=new Set,imageList=[],inputType="";let initInputType="";var cropMode=!0,forceMode=!1,backColor="#f5f5f5",resizingFactor=.5,resizingWidth=0,resizingHeight=0,description=" ",minSizeValue=50,maxSizeValue=3e3,maxFileNumberAllowed=10,appName="FreeImageResizer",standardSizeLeyend="",alert_timeout;class imageData{constructor(name,url,id_btn,id_file,size_old,size_new,ext_old,ext_new,res_old,res_new){this.valid=!0,this.name=name,this.url=url,this.id_btn=id_btn,this.id_file=id_file,this.ext_old=ext_old,this.ext_new=ext_new,this.size_old=size_old,this.size_new=size_new,this.res_old=res_old,this.res_new=res_new}}function saveImageData(name,url,size_old,ext_old,id_file){let id=imageList.length;var new_image=new imageData;return new_image.name=name,new_image.url=url,new_image.size_old=size_old,new_image.ext_old=ext_old.toUpperCase(),new_image.ext_new="-",new_image.id_file=id_file,new_image.size_new="? (not calculated yet)",new_image.res_old="0x0",new_image.res_new="0x0",imageList.push(new_image),id}function removeImageData(id_file){for(let i=0;i<imageList.length;i++){let id=i;if(imageList[id].id_file==id_file){imageList[id].valid=!1;let img_pre=document.getElementById("img_pre_"+id),img_res=document.getElementById("img_res_"+id),s_div=document.getElementById("s_div_"+id),m_div=document.getElementById("m_div_"+id);return isNaN(img_pre)&&s_div.remove(),isNaN(img_res)&&s_div.remove(),isNaN(s_div)&&s_div.remove(),void(isNaN(m_div)&&m_div.remove())}}console.error("Trying to remove a not found image.")}function setSelectListOptions(){for(var i=0;i<presetSizeDataList.length;i++)presetSizeCategorySet.add(presetSizeDataList[i].category);let selectList=document.createElement("select"),presetSizeContainer=document.createElement("div");function loadAllButtonsCategory(category){let cat_container=document.createElement("div");cat_container.name=category,0!=c&&(cat_container.style.display="none"),cat_container.classList.add("category-container"),cat_container.id="cat_"+category,presetSizeContainer.appendChild(cat_container);for(let i=0;i<presetSizeDataList.length;i++)if(presetSizeDataList[i].category==category){let btn_container=document.createElement("div"),button=document.createElement("button"),tag_name=document.createElement("span"),tag_size=document.createElement("span");btn_container.className="preset-size-button-container",button.id=presetSizeDataList[i].name,button.className="preset-size-button",button.innerHTML=presetSizeDataList[i].prop,button.onclick=function(){inputButtonPresetUpdate(this.id)},tag_name.innerHTML=presetSizeDataList[i].tag,tag_name.className="preset-size-tag-name",tag_size.innerHTML=presetSizeDataList[i].width+"x"+presetSizeDataList[i].height,tag_size.className="preset-size-tag-size",btn_container.appendChild(button),btn_container.appendChild(tag_name),btn_container.appendChild(tag_size),cat_container.appendChild(btn_container)}}selectList.name="presetList",selectList.className="preset-list",presetSizeContainer.name="presetSizeContainer",presetSizeContainer.classList.add("py-2");let c=0;for(let category of presetSizeCategorySet)selectList.options[c]=new Option(category,category),loadAllButtonsCategory(category),c+=1;selectList.addEventListener("change",(function(){for(let category of presetSizeCategorySet){let category_id="cat_"+category,element=document.getElementById(category_id);category==selectList.value?element.style.display="block":element.style.display="none"}})),presetListContainer.appendChild(selectList),presetListContainer.appendChild(presetSizeContainer)}function clearValues(){resizingFactor=.5,resizingWidth=0,resizingHeight=0,inputSlider.value=50,inputWidth.value="",inputHeight.value="",inputType=initInputType}function clearStyles(){inputSlider.classList.remove("scale-slider-selected"),inputWidth.classList.remove("input-value-selected"),inputHeight.classList.remove("input-value-selected");for(let i=0;i<presetSizeDataList.length;i++){let element;document.getElementById(presetSizeDataList[i].name).classList.remove("preset-size-selected")}}function displayState(show){if(show){resizeOptionsContainer.style.display="block",imageResizedContainer.style.display="none",imagePrevContainer.style.display="none",uploadBox.classList.remove("border-intense");let validLenght=0;for(let i=0;i<imageList.length;i++)imageList[i].valid&&(validLenght+=1);1==validLenght?(showTitle.innerHTML="Your resize image",showSingleBox.style.display="flex",showMultipleBox.style.display="none"):validLenght>1&&(showTitle.innerHTML="Your "+validLenght+" resize images",showSingleBox.style.display="none",showMultipleBox.style.display="flex"),imagesContainer.style.display="block",exampleImageContainer.style.display="none"}else uploadBox.classList.add("border-intense"),resizeOptionsContainer.style.display="none",imagesContainer.style.display="none",exampleImageContainer.style.display="block"}function dataDisplay(){if(description="All images were resized.<br> Input Type: "+inputType+"<br> crop mode: "+cropMode+"<br> resizing factor: "+100*resizingFactor+"%<br> width height: "+resizingWidth+" x "+resizingHeight+"<br> force mode: "+forceMode,"fixed"==inputType){let txt1;txt1=cropMode?"<b>croped</b> to":"<b>contained</b> in",txt1=cropMode?"<b>croped</b> to":"<b>contained</b> in",""!=standardSizeLeyend?description="All images were auto resize and "+txt1+" a standard size <b>"+standardSizeLeyend+"</b> with "+resizingWidth+" x "+resizingHeight+" px.":""==standardSizeLeyend&&0==resizingWidth&&0==resizingHeight?description="All images were <b>not resized</b>. We need width and height!":""==standardSizeLeyend&&0==resizingWidth?description="All images were auto resize and "+txt1+" a <b>custom height</b> of "+resizingHeight+" px and auto width.":""==standardSizeLeyend&&0==resizingHeight?description="All images were auto resize and "+txt1+" a <b>custom width</b> of "+resizingWidth+" px and auto height.":""==standardSizeLeyend&&0!=resizingHeight&&0!=resizingHeight&&(description="All images were auto resize and "+txt1+" a <b>custom width and height</b> of "+resizingWidth+"x"+resizingHeight+"px.")}"forced"==inputType&&(description=0!=resizingWidth&&0!=resizingHeight?"All images were <b>forced</b> to a custom size of "+resizingWidth+" x "+resizingHeight+" px.":0!=resizingWidth?"All images were auto resized but <b>not forced</b> using <b>Width: "+resizingWidth+" px</b>.":0!=resizingHeight?"All images were auto resized but <b>not forced</b> using <b>Height "+resizingHeight+" px</b>.":"All images were <b>not resized</b>. Force mode is active, but we need width and height!"),"percentage"==inputType&&(description="All images were auto resize to <b>percentage of "+parseInt(100*resizingFactor)+"%</b> of it original size."),showDescription.innerHTML=description;for(let i=0;i<imageList.length;i++)if(imageList[i].valid){let n=parseInt(i)+1,s_text=document.getElementById("s_txt_"+i),s_size=document.getElementById("s_siz_"+i),m_text=document.getElementById("m_txt_"+i),m_size=document.getElementById("m_siz_"+i);s_text.innerHTML="Resized image No. "+n+" in "+imageList[i].ext_old+".",m_text.innerHTML="Resized image No. "+n+" in "+imageList[i].ext_old+".",s_size.innerHTML=imageList[i].res_new,m_size.innerHTML=imageList[i].res_new}}function checkAutoUpdateMode(){!0===autoUpdate?(updateCheckbox.checked=!0,updateButton.style.display="none"):(autoUpdate=!1,updateButton.style.display="block")}presetSizeDataList&&setSelectListOptions();for(var i=0;i<exampleImage.length;i++)exampleImage[i].onclick=function(){let url;uploadCustomFile(this.src.replace("-thumb.webp",".jpg"))};function addResizedImageToDOM(fileItem,id){var new_res=document.createElement("img");new_res.id="img_res_"+id,new_res.className="singleImage",new_res.src=URL.createObjectURL(fileItem.file),imageResizedContainer.appendChild(new_res)}function addResizedImageToDOM_ShowSingle(fileItem,id){var s_container=document.createElement("div"),s_column1=document.createElement("div"),s_column2=document.createElement("div"),s_show=document.createElement("div"),s_siz=document.createElement("div"),s_img=document.createElement("img"),s_txt=document.createElement("p"),s_btn=document.createElement("button"),s_mob=document.createElement("div");s_container.id="s_div_"+id,s_container.classList.add("row"),s_column1.classList.add("col-sm-8"),s_column2.classList.add("col"),s_show.classList.add("show-single-image"),s_siz.id="s_siz_"+id,s_siz.classList.add("show-size-tag"),s_siz.innerHTML="0x0",s_img.id="s_img_"+id,s_img.className="singleImage",s_img.src=URL.createObjectURL(fileItem.file),s_txt.innerHTML="Image description",s_txt.id="s_txt_"+id,s_btn.innerHTML="<i class='bi bi-download bi-mr'></i> Download",s_btn.type="button",s_btn.id="s_btn_"+id,s_btn.onclick=function(){let filename=appName+"-"+imageList[id].name,url=imageList[id].url;var element=document.createElement("a");element.setAttribute("href",url),element.setAttribute("download",filename),document.body.appendChild(element),element.click()},s_btn.classList.add("btn"),s_btn.classList.add("btn-download"),s_mob.classList.add("mobile-download-tag"),s_mob.classList.add("py-2"),s_mob.classList.add("text-center"),s_mob.classList.add("d-sm-none"),s_mob.innerHTML="Or click image and Add to Photos <i class='bi bi-box-arrow-down'></i>",s_show.appendChild(s_img),s_show.appendChild(s_siz),s_column1.appendChild(s_show),s_column2.appendChild(s_txt),s_column2.appendChild(s_btn),s_column2.appendChild(s_mob),s_container.appendChild(s_column1),s_container.appendChild(s_column2),showSingleBox.appendChild(s_container)}function addResizedImageToDOM_ShowMultiple(fileItem,id){var m_container=document.createElement("div"),m_show=document.createElement("div"),m_siz=document.createElement("div"),m_img=document.createElement("img"),m_txt=document.createElement("p"),m_btn=document.createElement("button"),m_mob=document.createElement("div");m_container.classList.add("col-sm-3"),m_container.classList.add("my-4"),m_container.id="m_div_"+id,m_show.classList.add("show-multiple-image"),m_siz.id="m_siz_"+id,m_siz.classList.add("show-size-tag"),m_siz.innerHTML="0x0",m_img.id="m_img_"+id,m_img.className="singleImage",m_img.src=URL.createObjectURL(fileItem.file),m_txt.innerHTML="Image description",m_txt.id="m_txt_"+id,m_btn.innerHTML="<i class='bi bi-download bi-mr'></i> Download",m_btn.type="button",m_btn.id="m_btn_"+id,m_btn.onclick=function(){let filename=appName+"-"+imageList[id].name,url=imageList[id].url;var element=document.createElement("a");element.setAttribute("href",url),element.setAttribute("download",filename),document.body.appendChild(element),element.click()},m_btn.classList.add("btn"),m_btn.classList.add("btn-download"),m_mob.classList.add("mobile-download-tag"),m_mob.classList.add("py-2"),m_mob.classList.add("text-center"),m_mob.classList.add("d-sm-none"),m_mob.innerHTML="Or click image and Add to Photos <i class='bi bi-box-arrow-down'></i>",m_show.appendChild(m_img),m_show.appendChild(m_siz),m_container.appendChild(m_show),m_container.appendChild(m_txt),m_container.appendChild(m_btn),m_container.appendChild(m_mob),showMultipleBox.appendChild(m_container)}function addPrevImageToDOM(fileItem,id){var new_img=document.createElement("img");new_img.id="img_pre_"+id,new_img.className="singleImage",new_img.src=URL.createObjectURL(fileItem.file),imagePrevContainer.appendChild(new_img)}function resizeModeDisplay(mode){localStorage.setItem("user-resize-mode-display",mode);let pre="btn-mode-",s=pre+"standard",c=pre+"custom",p=pre+"percentage",sc="btn-resize-mode-sel",ac="arr-resize-mode-sel";function modeClear(){document.getElementById(s).classList.remove(sc),document.getElementById(c).classList.remove(sc),document.getElementById(p).classList.remove(sc),document.getElementById(s+"-ar").classList.remove(ac),document.getElementById(c+"-ar").classList.remove(ac),document.getElementById(p+"-ar").classList.remove(ac),optionsBoxMode.style.display="none",optionsBoxPreset.style.display="none",optionsBoxCustomSize.style.display="none",optionsBoxPrecentage.style.display="none"}modeClear(),mode==pre+"standard"?(document.getElementById(s).classList.add(sc),document.getElementById(s+"-ar").classList.add(ac),optionsBoxMode.style.display="block",optionsBoxPreset.style.display="block"):"btn-mode-custom"==mode?(document.getElementById(c).classList.add(sc),document.getElementById(c+"-ar").classList.add(ac),optionsBoxMode.style.display="block",optionsBoxCustomSize.style.display="block"):"btn-mode-percentage"==mode&&(document.getElementById(p).classList.add(sc),document.getElementById(p+"-ar").classList.add(ac),optionsBoxPrecentage.style.display="block")}function inputButtonPresetUpdate(button_id){let w,h,c,p,l,element;for(let i=0;i<presetSizeDataList.length;i++)button_id==presetSizeDataList[i].name&&(w=presetSizeDataList[i].width,h=presetSizeDataList[i].height,c=presetSizeDataList[i].category,p=presetSizeDataList[i].prop,l=presetSizeDataList[i].tag);clearValues(),resizingWidth=w,resizingHeight=h,standardSizeLeyend=p+" "+l,inputType="fixed",clearStyles(),document.getElementById(button_id).classList.add("preset-size-selected"),updateCheckbox.checked&&updateImagesResize()}function preventUserMinMax(value,text){return isNaN(value)?(messageToUser(text+" should be a numeric value."),""):0==value?"":value<50?(messageToUser(text+" of "+value+" px is too small, min value is 50 px."),""):value>3e3?(messageToUser(text+" of "+value+" px is too big, max value is 3000 px."),""):value}function messageToUser(message){console.log("This is a message to the user: ",message),alert_timeout&&clearTimeout(alert_timeout);var a_div=document.createElement("div");a_div.classList.add("alert"),a_div.classList.add("alert-warning"),a_div.classList.add("alert-dismissible"),a_div.classList.add("fade"),a_div.classList.add("show"),a_div.classList.add("alert-fixed"),a_div.innerHTML="<i class='bi-exclamation-triangle-fill'></i> "+message+"<button type='button' class='btn-close' data-bs-dismiss='alert'></button>",alert_timeout=setTimeout((function(){let clickeableButtons=liveAlertPlaceholder.getElementsByClassName("btn-close");for(let i=0;i<clickeableButtons.length;i++)clickeableButtons[i].click()}),5e3),liveAlertPlaceholder.appendChild(a_div)}function resizeImage(id){let img_old=document.getElementById("img_pre_"+id),img_new=document.getElementById("img_res_"+id),img_s=document.getElementById("s_img_"+id),img_m=document.getElementById("m_img_"+id),canvas=downScaleImage(img_old,inputType,cropMode,backColor,resizingFactor,resizingWidth,resizingHeight);if(null==canvas)return void console.error("Downsample not possible, canvas undefined");let type="image/"+imageList[id].ext_old,canvasData=canvas.toDataURL(type);img_new.src=canvasData,isNaN(img_s)&&(img_s.src=canvasData),img_m.src=canvasData,imageList[id].url=img_new.src,img_new.onload=function(){imageList[id].res_old=img_old.width+" x "+img_old.height,imageList[id].res_new=img_new.width+" x "+img_new.height,dataDisplay();let placeholder=img_s.parentElement.getElementsByClassName("placeholder");placeholder||(placeholder.hidden=!0)},dataDisplay(),img_old.onload=function(){updateImagesResize()}}function updateImagesResize(){for(let i=0;i<imageList.length;i++)if(!0===imageList[i].valid){let id;resizeImage(parseInt(i))}}resizeMethod.addEventListener("click",event=>{let button;"BUTTON"===event.target.nodeName&&resizeModeDisplay(event.target.id)}),updateCheckbox.onchange=function(){this.checked?(autoUpdate=!0,updateButton.style.display="none",updateImagesResize()):(autoUpdate=!1,updateButton.style.display="block")},cropModeCheckbox.onchange=function(){this.checked?(cropMode=!0,containModeCheckbox.checked=!1,updateCheckbox.checked&&updateImagesResize()):(cropMode=!1,containModeCheckbox.checked=!0)},containModeCheckbox.onchange=function(){this.checked?(cropMode=!1,cropModeCheckbox.checked=!1,updateCheckbox.checked&&updateImagesResize()):(cropMode=!0,cropModeCheckbox.checked=!0)},backColorPicker.onchange=function(){backColor=this.value,updateCheckbox.checked&&updateImagesResize()},autoForceWidthHeightCheckbox.onchange=function(){this.checked?(inputType="forced",forceMode=!0):(inputType="fixed",forceMode=!1),updateCheckbox.checked&&updateImagesResize()},updateButton.onclick=function(){updateImagesResize()},inputSlider.onchange=function(){let i=this.value;clearValues(),this.value=i,resizingFactor=i/100,inputType="percentage",clearStyles(),this.classList.add("scale-slider-selected"),updateCheckbox.checked&&updateImagesResize()},inputWidth.onchange=function(){this.value=preventUserMinMax(this.value,"Width");let i=this.value,z=inputHeight.value;clearValues(),this.value=i,inputHeight.value=z,resizingWidth=parseInt(i),resizingHeight=parseInt(z),inputType="fixed",standardSizeLeyend="",isNaN(resizingWidth)&&(resizingWidth=0),isNaN(resizingHeight)&&(resizingHeight=0),clearStyles(),this.classList.add("input-value-selected"),inputHeight.classList.add("input-value-selected"),forceMode&&(inputType="forced"),updateCheckbox.checked&&updateImagesResize()},inputHeight.onchange=function(){this.value=preventUserMinMax(this.value,"Height");let i=this.value,z=inputWidth.value;clearValues(),this.value=i,inputWidth.value=z,resizingHeight=parseInt(i),resizingWidth=parseInt(z),inputType="fixed",standardSizeLeyend="",isNaN(resizingWidth)&&(resizingWidth=0),isNaN(resizingHeight)&&(resizingHeight=0),clearStyles(),this.classList.add("input-value-selected"),inputWidth.classList.add("input-value-selected"),forceMode&&(inputType="forced"),updateCheckbox.checked&&updateImagesResize()};const input=document.querySelector('input[type="file"]'),pond=FilePond.create(input,{acceptedFileTypes:["image/*"],name:"filepond",credits:!1,dropOnElement:!1,dropOnPage:!0,styleButtonRemoveItemPosition:"right",labelIdle:'Drag & drop multiple images<br/><span class="filepond--label-action">or browse to upload</span>',server:{},onaddfile:(err,fileItem)=>{let id=saveImageData(fileItem.file.name,URL.createObjectURL(fileItem.file),fileItem.fileSize,fileItem.fileExtension,fileItem.id);addPrevImageToDOM(fileItem,id),addResizedImageToDOM(fileItem,id),addResizedImageToDOM_ShowSingle(fileItem,id),addResizedImageToDOM_ShowMultiple(fileItem,id),autoUpdate&&resizeImage(id),displayState(!0)},onremovefile:function(error,fileItem){removeImageData(fileItem.id);let off=!0;for(let i=0;i<imageList.length;i++)!0===imageList[i].valid&&(off=!1);displayState(!off),dataDisplay()},onwarning:function(error){"Max files"==error.body?messageToUser("You are trying to upload more than 10 files."):messageToUser("We found some error uploading your file...")}});function uploadCustomFile(src){pond.addFile(src)}pond.maxFiles=10,pond.allowReorder=!1,window.matchMedia("(min-width: 500px)").matches||(pond.labelIdle='<span class="filepond--label-action">Click to upload</span><br>multiple images');var autoUpdate=!0;checkAutoUpdateMode(),displayState(!1),dataDisplay(),resizingWidth=900,resizingHeight=600;let initResizeMode=localStorage.getItem("user-resize-mode-display");initResizeMode||(initResizeMode="btn-mode-standard"),resizeModeDisplay(initResizeMode),initInputType="fixed";let presetSizeFirstButton=document.getElementsByClassName("preset-size-button");presetSizeFirstButton[0]&&presetSizeFirstButton[0].click()});